(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1659:function(e,a,t){e.exports=t(1660).default,e.exports.default=e.exports},1660:function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0});var n=t(1661);function r(a,t){return void 0===t&&(t="utf8"),e.isBuffer(a)?s(a.toString("base64")):s(e.from(a,t).toString("base64"))}function i(e){return e=e.toString(),n.default(e).replace(/\-/g,"+").replace(/_/g,"/")}function s(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var l=r;l.encode=r,l.decode=function(a,t){return void 0===t&&(t="utf8"),e.from(i(a),"base64").toString(t)},l.toBase64=i,l.fromBase64=s,l.toBuffer=function(a){return e.from(i(a),"base64")},a.default=l}).call(this,t(101).Buffer)},1661:function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(a){var t=a.length,n=t%4;if(!n)return a;var r=t,i=4-n,s=t+i,l=e.alloc(s);for(l.write(a);i--;)l.write("=",r++);return l.toString()}}).call(this,t(101).Buffer)},2040:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),i=t(1390),s=t(1300),l=t(930),o=t(258),c=t(45),u=t.n(c),d=t(1388),g=t(1304),m=t(1324),p=t(1327),f=t(1328),b=t(1493),E=t(1329),h=t(1412),A=t(1333),S=t(1364),y=t(1371),v=t(1400),C=t(1404),M=t(1402),N=t(1403),q=t(1401),T=t(961),w=t(1374),I=t.n(w),j=t(407),x=t(259),O=t(941),R=t(1399),P=t(1313),k=t(1326),B=t(1299),W=t(1409),F=t(1392),H=t(1397),z=t(1396),D=t(1395),L=t(1394),U=t(1659),V=t.n(U);const _={AbnormalRequestsPerMin:"requestCount"},J=e=>{const{alertType:a,api:t,alertName:i,classes:l,intl:c,setIsWorkerNodeDown:u}=e,[m,p]=Object(n.useState)([]),[f,b]=Object(n.useState)(),[E,h]=Object(n.useState)(),[v,C]=Object(n.useState)(new Set),[M,N]=Object(n.useState)([]),[q,w]=Object(n.useState)([]),[I,j]=Object(n.useState)(),[x,U]=Object(n.useState)(),[J,Y]=Object(n.useState)({}),[G,K]=Object(n.useState)(!1),[Q,X]=Object(n.useState)();Object(n.useEffect)(()=>{const e=t.getAlertConfigurations(a),n=t.getAllAPIs();Promise.all([e,n]).then(e=>{const a=e[1].body.list,t=new Set;a.forEach(e=>{t.add(e.name)}),C(t),b(a),p(e[0].body)}).catch(e=>{console.log(e),u(!0)})},[]);const Z=e=>{t.getAlertConfigurations(a).then(e=>{p(e.body)}).catch().finally(()=>{Y({[e]:!1})})};return f&&m?r.a.createElement(r.a.Fragment,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{onClick:()=>K(!G),color:"primary"},r.a.createElement(s.a,{className:l.addBtn},r.a.createElement(S.a,{color:"primary"},"add"),r.a.createElement(o.a,{id:"Settings.Alert.AlertConfiguration.add",defaultMessage:"New Configuration"}))),r.a.createElement(R.a,{in:G,className:l.configWrapper},r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:!0},r.a.createElement(P.a,{id:"outlined-select-api-name",select:!0,fullWidth:!0,required:!0,label:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.api.name.label",defaultMessage:"API Name"}),className:l.textField,value:E,onChange:e=>(e=>{h(e);const a=f.filter(a=>a.name===e);N(a)})(e.target.value),SelectProps:{MenuProps:{className:l.menu}},helperText:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.select.api.helper",defaultMessage:"Select the API Name"}),variant:"outlined"},v&&Array.from(v).map(e=>r.a.createElement(k.a,{key:e,value:e},e)))),r.a.createElement(d.a,{item:!0,xs:!0},r.a.createElement(P.a,{id:"outlined-select-api-version",select:!0,fullWidth:!0,required:!0,label:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.api.version.label",defaultMessage:"API Version"}),className:l.textField,value:I,onChange:e=>(e=>{j(e);const a=f.filter(a=>a.name===E&&a.version===e);a.length>0&&t.getSubscriptions(a[0].id).then(e=>{const a=e.body.list.map(e=>e.applicationInfo);w(a)}).catch(e=>{console.log(e)})})(e.target.value),SelectProps:{MenuProps:{className:l.menu}},helperText:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.select.version.helper",defaultMessage:"Select API Version"}),variant:"outlined"},M&&M.map(e=>r.a.createElement(k.a,{key:e.version,value:e.version},e.version)))),r.a.createElement(d.a,{item:!0,xs:!0},r.a.createElement(P.a,{id:"outlined-select-applications",select:!0,fullWidth:!0,required:!0,label:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.applications.label",defaultMessage:"Application"}),className:l.textField,value:Q,onChange:e=>X(e.target.value),SelectProps:{MenuProps:{className:l.menu}},helperText:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.select.application.helper",defaultMessage:"Select Application"}),variant:"outlined"},q&&q.map(e=>r.a.createElement(k.a,{key:e.applicationId,value:e.name},e.name)))),r.a.createElement(d.a,{item:!0,xs:!0},r.a.createElement(P.a,{id:"outlined-value",type:"number",fullWidth:!0,required:!0,label:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.request.count.label",defaultMessage:"Request Count."}),className:l.textField,value:x,onChange:e=>U(e.target.value),variant:"outlined",endAdornment:r.a.createElement(B.a,{position:"end"},"ms"),helperText:r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.threshold.value.helper",defaultMessage:"Enter Request Count."})})),r.a.createElement(d.a,{item:!0,className:l.configAddBtnContainer},r.a.createElement(W.a,{disabled:(()=>!E||!I||!Q||!x||J.add)(),color:"primary",size:"medium",onClick:()=>{Y({add:!0});const e=V.a.encode(E+"#"+I+"#"+Q),n={apiName:E,apiVersion:I,applicationName:Q,requestCount:x};t.putAlertConfiguration(a,n,e).then(()=>{O.a.info(c.formatMessage({id:"Settings.Alert.AlertConfiguration.alert.config.add.success.msg",defaultMessage:"Alert Configuration added successfully"})),h(""),j(""),X(""),U("")}).catch(()=>{O.a.error(c.formatMessage({id:"Settings.Alert.AlertConfiguration.alert.config.add.error.msg",defaultMessage:"Error occurred while adding alert configuration"}))}).finally(()=>{Z("add")})}},r.a.createElement(S.a,null,J.add&&r.a.createElement(g.a,{size:15}),"add")))))),r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{className:l.configNameHeading},r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.configuration",defaultMessage:"{name} Configurations",values:{name:i}})),0===m.length?r.a.createElement(T.a,{height:80},r.a.createElement("div",{className:l.contentWrapper},r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.no.config.message",defaultMessage:"You do not have any configurations. Click on {newConfig} button to add a configuration.",values:{newConfig:r.a.createElement("b",null,"New Configuration")}})))):r.a.createElement(F.a,null,r.a.createElement(H.a,null,r.a.createElement(z.a,null,r.a.createElement(D.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.api.name",defaultMessage:"API Name"})),r.a.createElement(D.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.api.version",defaultMessage:"API Version"})),r.a.createElement(D.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.AlertConfiguration.app.name",defaultMessage:"Application Name"})),r.a.createElement(D.a,null,i),r.a.createElement(D.a,null))),r.a.createElement(L.a,null,m.map(e=>r.a.createElement(z.a,{id:e.configurationId,key:e.configurationId},r.a.createElement(D.a,null,e.configuration.apiName),r.a.createElement(D.a,null,e.configuration.apiVersion),r.a.createElement(D.a,null,e.configuration.applicationName),r.a.createElement(D.a,null,e.configuration[_[a]]),r.a.createElement(D.a,null,r.a.createElement(A.a,{onClick:()=>(e=>{Y({delete:e}),t.deleteAlertConfiguration(a,e).then(()=>{O.a.info(c.formatMessage({id:"Settings.Alert.AlertConfiguration.alert.config.delete.success.msg",defaultMessage:"Alert Configuration deleted successfully"}))}).catch(()=>{O.a.error(c.formatMessage({id:"Settings.Alert.AlertConfiguration.alert.config.delete.error.msg",defaultMessage:"Error occurred while deleting the configuration."}))}).finally(()=>{Z("delete")})})(e.configurationId)},J.delete===e.configurationId?r.a.createElement(g.a,{size:15}):r.a.createElement(S.a,null,"delete"))))))))):r.a.createElement(g.a,null)};J.propTypes={alertType:u.a.string.isRequired,alertName:u.a.string.isRequired,classes:u.a.shape({}).isRequired,api:u.a.shape({}).isRequired,intl:u.a.shape({}).isRequired};var Y=Object(o.d)(Object(l.a)(e=>({addBtn:{display:"flex",alignItems:"center"},configAddBtnContainer:{display:"flex",paddingBottom:e.spacing(2)},configWrapper:{padding:e.spacing(2)},configNameHeading:{marginBottom:e.spacing(),borderBottom:"#cccccc 1px inset"}}))(J));const G=e=>{const{classes:a,intl:t}=e,[i,l]=Object(n.useState)({open:!1,alertType:"",name:""}),[c,u]=Object(n.useState)([]),[w,R]=Object(n.useState)(),[P,k]=Object(n.useState)([]),[B,W]=Object(n.useState)(!1),[F,H]=Object(n.useState)({subscribing:!1,unSubscribing:!1}),[z,D]=Object(n.useState)(!1),[L,U]=Object(n.useState)(!1),V=new x.a,_={3:{name:t.formatMessage({id:"Settings.Alerts.Alerts.abnormal.response.time",defaultMessage:"Abnormal Requests per Minute"}),displayName:"AbnormalRequestsPerMin",description:t.formatMessage({id:"Settings.Alerts.Alerts.abnormal.request.per.min.description",defaultMessage:"This alert is triggered if there is a sudden spike the request count within a period of one minute by default for a particular API for an application. These alerts could be treated as an indication of a possible high traffic, suspicious activity, possible malfunction of the client application, etc."})},4:{name:t.formatMessage({id:"Settings.Alerts.Alerts.abnormal.backend.time",defaultMessage:"Abnormal Resource Access"}),displayName:"AbnormalRequestPattern",description:t.formatMessage({id:"Settings.Alerts.Alerts.abnormal.request.pattern.description",defaultMessage:"This alert is triggered if there is a change in the resource access pattern of a user of a particular application. These alerts could be treated as an indication of a suspicious activity by a user over your application."})},5:{name:t.formatMessage({id:"Settings.Alerts.Alerts.numusual.ip",defaultMessage:"Unusual IP Access"}),displayName:"UnusualIPAccess",description:t.formatMessage({id:"Settings.Alerts.Alerts.unusual.ip.access.description",defaultMessage:"This alert is triggered if there is either a change in the request source IP for a particular application by a user or if the request is from an IP used before a time period of 30 days (default). These alerts could be treated as an indication of a suspicious activity by a user over an application."})},6:{name:t.formatMessage({id:"Settings.Alerts.Alerts.frequent.tier",defaultMessage:"Frequent Tier Limit Hitting"}),displayName:"FrequentTierLimitHitting",description:t.formatMessage({id:"Settings.Alerts.Alerts.tier.limit.hitting.description",defaultMessage:"This alert is triggered if at least one of the two cases below are satisfied. If a particular application gets throttled out for hitting the subscribed tier limit of that application more than 10 times (by default) within an hour (by default) or if a particular user of an application gets throttled out for hitting the subscribed tier limit of a particular API more than 10 times (by default) within a day (by default)"})}},J=e=>P.some(a=>a.id===e),G=e=>{const a=e.id;let t=[...P];if(J(a))t=t.filter(e=>e.id!==a);else{const e={id:a,name:_[a].displayName,configuration:[]};t.push(e)}e.requireConfiguration&&(e=>{V.getAlertConfigurations(e.displayName).then(a=>{0===a.body.length&&l({open:!0,alertType:e.displayName,name:e.name})}).catch(e=>console.log(e))})(_[a]),k(t)};Object(n.useEffect)(()=>{const e=V.getSupportedAlertTypes(),a=V.getSubscribedAlertTypesByUser();Promise.all([e,a]).then(e=>{204===e[0].status||204===e[1].status?W(!1):(W(!0),k(e[1].body.alerts),u(e[1].body.emailList),R(e[0].body.alerts))}).catch(e=>{W(!1),k({}),console.error(e),O.a.error(t.formatMessage({id:"Settings.Alerts.Alerts.loading.error.msg",defaultMessage:"Error occurred while loading alerts"}))})},[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:a.alertsWrapper},B?r.a.createElement(r.a.Fragment,null,w?r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{variant:"h6",className:a.manageAlertHeading},r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.subscribe.to.alerts.heading",defaultMessage:"Manage Alert Subscriptions"})),r.a.createElement(s.a,{variant:"caption"},r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.subscribe.to.alerts.subheading",defaultMessage:"Select the Alert types to subscribe/ unsubscribe and click Save."})),r.a.createElement(m.a,null,w&&w.map(e=>r.a.createElement(p.a,{key:e.id,divider:!0},r.a.createElement(f.a,null,r.a.createElement(b.a,{edge:"start",tabIndex:-1,value:e.id,checked:J(e.id),onChange:()=>G(e),inputProps:{"aria-labelledby":e.name},color:"primary"})),r.a.createElement(E.a,{id:e.id,primary:_[e.id].name,secondary:_[e.id].description,className:a.listItem}),!0===e.requireConfiguration?r.a.createElement(h.a,null,r.a.createElement(A.a,{onClick:()=>(e=>{l({open:!0,alertType:_[e].displayName,name:_[e].name})})(e.id)},r.a.createElement(S.a,null,"settings"))):r.a.createElement("div",null)))),r.a.createElement(I.a,{label:"Emails",variant:"outlined",className:a.chipInput,value:c,placeholder:"Enter email address and press Enter",required:!0,helperText:"Email address to receive alerts of selected Alert types. Type email address and press Enter to add",onChange:e=>{(e=>{u(e)})(e)},onDelete:e=>{(e=>{const a=c.filter(a=>a!==e);u(a)})(e)}}),r.a.createElement(d.a,{container:!0,direction:"row",spacing:2,className:a.btnContainer},r.a.createElement(d.a,{item:!0},r.a.createElement(y.a,{disabled:0===c.length||0===P.length,onClick:()=>{H({subscribing:!0});const e={alerts:P,emailList:c};V.subscribeAlerts(e).then(()=>{O.a.success(t.formatMessage({id:"Settings.Alerts.Alerts.subscribe.success.msg",defaultMessage:"Subscribed to Alerts Successfully."}))}).catch(e=>{console.error(e),O.a.error(t.formatMessage({id:"Settings.Alerts.Alerts.subscribe.error.msg",defaultMessage:"Error occurred while subscribing to alerts."}))}).finally(()=>H({subscribing:!1}))},variant:"contained",color:"primary"},F.subscribing&&r.a.createElement(g.a,{size:15}),"Save")),r.a.createElement(d.a,{item:!0},r.a.createElement(y.a,{disabled:F.subscribing,color:"primary",variant:"contained",onClick:()=>D(!0)},F.unSubscribing&&r.a.createElement(g.a,{size:15}),"Unsubscribe All")),r.a.createElement(d.a,{item:!0},r.a.createElement(j.a,{to:"/apis/"},r.a.createElement(y.a,{disabled:F.subscribing,variant:"contained",color:"default"},F.unSubscribing&&r.a.createElement(g.a,{size:15}),"Cancel"))))):r.a.createElement(g.a,null)):r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{type:"info",height:100},r.a.createElement("div",null,r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.enable.analytics.message",defaultMessage:"Enable Analytics to Configure Alerts"})))))),r.a.createElement(v.a,{open:i.open},r.a.createElement(C.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.configure.alert",defaultMessage:"Configurations"})),L?r.a.createElement(M.a,null,r.a.createElement(N.a,{id:"analytics-dialog-description"},r.a.createElement(o.a,{id:"Apis.Settings.Alerts.connection.error",defaultMessage:"Could not connect to analytics server. Please check the connectivity."}))):r.a.createElement(M.a,null,r.a.createElement(Y,{alertType:i.alertType,alertName:i.name,api:V,setIsWorkerNodeDown:U})),r.a.createElement(q.a,null,r.a.createElement(y.a,{color:"primary",variant:"outlined",onClick:()=>l({open:!1})},r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.close.btn",defaultMessage:"Close"}))))),r.a.createElement(v.a,{open:z},r.a.createElement(C.a,null,r.a.createElement(s.a,{className:a.configDialogHeading},r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.unsubscribe.confirm.dialog.heading",defaultMessage:"Confirm unsubscription from All Alerts"}))),r.a.createElement(M.a,null,r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.unsubscribe.confirm.dialog.message",defaultMessage:"This will remove all the existing alert subscriptions and emails. This action cannot be undone."}))),r.a.createElement(q.a,null,r.a.createElement(y.a,{color:"primary",size:"small",onClick:()=>{H({unSubscribing:!0}),V.unsubscribeAlerts().then(()=>{k([]),u([]),O.a.success(t.formatMessage({id:"Settings.Alerts.Alerts.unsubscribe.success.msg",defaultMessage:"Unsubscribed from all alerts successfully."}))}).catch(e=>{console.error(e),O.a.error(t.formatMessage({id:"Settings.Alerts.Alerts.unsubscribe.error.msg",defaultMessage:"Error occurred while unsubscribing."}))}).finally(()=>H({unSubscribing:!1})),D(!1)}},r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.confirm.btn",defaultMessage:"Unsubscribe All"}))),r.a.createElement(y.a,{color:"secondary",size:"small",onClick:()=>D(!1)},r.a.createElement(s.a,null,r.a.createElement(o.a,{id:"Settings.Alerts.Alerts.cancel.btn",defaultMessage:"Cancel"}))))))};G.propTypes={classes:u.a.shape({configDialogHeading:u.a.string.isRequired,chipInput:u.a.string.isRequired,btnContainer:u.a.string.isRequired,alertsWrapper:u.a.string.isRequired,manageAlertHeading:u.a.string.isRequired}).isRequired,intl:u.a.shape({formatMessage:u.a.func.isRequired}).isRequired};var K=Object(o.d)(Object(l.a)(e=>({alertsWrapper:{padding:e.spacing(2),"& span, & h5, & label, & input, & td, & li":{color:e.palette.getContrastText(e.palette.background.paper)}},manageAlertHeading:{marginBottom:e.spacing()},chipInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},alertConfigDialog:{width:"60%"},configDialogHeading:{fontWeight:"600"},btnContainer:{marginTop:e.spacing()},listItem:{marginLeft:e.spacing(1)}}))(G));function Q(e){const{classes:a}=e;return r.a.createElement("div",{className:a.settingsRoot},r.a.createElement(d.a,{container:!0,direction:"column",spacing:2},r.a.createElement(d.a,{item:!0},r.a.createElement(K,null))))}Q.propTypes={classes:u.a.shape({settingsRoot:u.a.string.isRequired}).isRequired};var X=Object(l.a)(e=>({settingsRoot:{padding:e.spacing(),width:"100%"}}))(Q);function Z(e){const{classes:a}=e;return r.a.createElement(i.a,{fixed:!0},r.a.createElement("div",{className:a.headingWrapper},r.a.createElement(s.a,{variant:"h5"},r.a.createElement(o.a,{id:"Apis.Settings.SettingsBase.header",defaultMessage:"Settings"})),r.a.createElement(s.a,{variant:"caption"},r.a.createElement(o.a,{id:"Apis.Settings.SettingsBase.sub.header",defaultMessage:"View and Configure Developer Portal Settings"}))),r.a.createElement(X,null))}Z.propTypes={classes:u.a.shape({}).isRequired};a.default=Object(l.a)(e=>({root:{padding:e.spacing(3),width:"100%"},headingWrapper:{paddingTop:e.spacing(2),paddingBottom:e.spacing(2),paddingLeft:e.spacing(),"& span, & h5, & label, & input, & td, & li":{color:e.palette.getContrastText(e.palette.background.default)}}}))(Z)},961:function(e,a,t){"use strict";var n=t(1),r=t.n(n),i=t(45),s=t.n(i),l=t(930),o=t(1322),c=t(1364),u=t(1024);function d(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class g extends r.a.Component{constructor(){super(...arguments),d(this,"state",{value:0}),d(this,"handleExpandClick",()=>{this.setState(e=>({expanded:!e.expanded}))})}render(){const{classes:e,type:a}=this.props,t=a||"info";return r.a.createElement(o.a,{className:e.root,elevation:1},"info"===t&&r.a.createElement(c.a,{className:e.iconItem},"info"),"warn"===t&&r.a.createElement(c.a,{className:e.iconItem},"warning"),r.a.createElement(u.a,{height:100}),r.a.createElement("div",{className:e.content},this.props.children))}}g.propTypes={classes:s.a.shape({}).isRequired,type:s.a.string.isRequired},a.a=Object(l.a)(e=>({root:{display:"flex",minHeight:100,alignItems:"center",paddingLeft:e.spacing(2),borderRadius:e.shape.borderRadius,border:"solid 1px #ddd","& span.material-icons":{fontSize:60,color:e.custom.info.color},"& span, & h5, & label, & input":{color:e.palette.getContrastText(e.palette.background.paper)}},iconItem:{paddingRight:e.spacing(2),fontSize:60},button:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},content:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1)}}))(g)}}]);
//# sourceMappingURL=SettingsBase.10919f9d77f318209d4c.bundle.js.map